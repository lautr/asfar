(function(e,t,n){"use strict";function i(t,n,i){this.$el=e(t);this.pagecount=0;this.currentHash=null;this.default={selector:'a[href*="'+document.location.host+'"], a[href^="/"], a:not([href^="http://"])',target:i,sheBangFallback:true,sheBangInterval:150,html5Support:true,before:function(e,t){},success:function(e,t){},after:function(e,t){},error:function(e,t,n,r,i){},insert:function(t,n,r){e(n).html(r)},historyNext:function(e,t,n){this.opts.insert(e,t,n)},historyPrev:function(e,t,n){this.opts.insert(e,t,n)}};this.opts=e.extend(this.default,n);this.$el.data(r,this);this.$selector=e(this.opts.selector);this.init()}var r="js-asfar";i.prototype.pushState=function(e,t){if(this.opts.html5Support){history.pushState({type:"ajax"},"title "+this.pagecount,e);this.pagecount++}else{location.hash="#!"+e;this.currentHash=location.hash}};i.prototype.call=function(t,n,r){var i=this;i.opts.before(t,n);e.ajax({cache:false,async:true,type:"GET",dataType:"html",url:t,success:function(s){var o='<section id="asfar-fake">'+s+"</section>";if(0!==e(o).find(n).parent().size()){s=e(o).find(n).html()}i.opts.insert(t,n,s);if(true!==r){i.pushState(t)}i.opts.success(t,n);e(n).trigger("asfar",[t])},error:function(e,r,s){i.opts.error(e,r,s,t,n)}});i.opts.after(t,n)};i.prototype.init=function(){var t=this;if(typeof history.pushState==="undefined"){this.opts.html5Support=false}if(!this.opts.html5Support&&!this.opts.sheBangFallback){return false}if(!this.opts.html5Support){setInterval(function(){if(""===location.hash){if(null!==t.currentHash){t.call(location.hash.substring(2),t.opts.target,true);t.currentHash=null}}else{if(location.hash!==t.currentHash){t.call(location.hash.substring(2),t.opts.target,false)}}},t.opts.sheBangInterval)}else{window.onpopstate=function(e){if(e.state!==null){if("ajax"===e.state.type){t.call(document.location.pathname,t.opts.target,true)}}}}if(!this.opts.html5Support&&"#!"===location.hash.substring(0,2)){location.href=location.hash.substring(2)}this.$selector.on("click."+r,function(n){n.preventDefault();t.call(e(this).attr("href"),t.opts.target,false)});if(this.opts.html5Support){t.pushState(document.location.pathname)}};i.prototype.destroy=function(){this.$selector.off("."+r);this.$el.removeData(r);this.$el=null};e.fn.asfar=function(t){var n=e(this).selector;if(1===e(this).size()){return new i(this,t,n)}}})(jQuery,document,window)