(function(a){function b(b,c){var d=location.hash,e=0,f,g,h,i,j;if(typeof history.pushState==="undefined"){var k=false,l;l=this;setInterval(function(){if(location.hash!==d){l.call(location.hash.substring(2))}},100)}else{var k=true,l;l=this;window.onpopstate=function(a){if(a.state!==null){if("ajax"===a.state.type){l.call(document.location.pathname,target,true)}}}}this.before=function(a,b){};this.success=function(a,b){};this.after=function(a,b){};this.error=function(a,b){};this.insert=function(b,c,d){a(c).html(d)};this.call=function(d,e,f){e=typeof e!=="undefined"?e:"#content";f=typeof f!=="undefined"?f:false;var g=this;g.before(d,e);a.ajax({cache:false,async:true,type:"GET",url:d,success:function(f){if(0!==a(f).find(e).parent().size()){f=a(f).find(e).html()}g.insert(d,e,f);a(e).find(c).click(function(){event.preventDefault();this.call(a(this).attr("href"),e)});g.success(d,e);if(typeof b=="function"){b(d)}}});g.after(d,e);if(true!==f){this.pushState(d)}};this.pushState=function(a){if(true===k){history.pushState({type:"ajax"},"title "+this.pagecount,a);e++}else{location.hash="#!"+a;d=location.hash}};this.pushState(document.location.pathname)}"use strict";a.fn.asfar=function(){if("#!"===location.hash.substring(0,2)){location.href=location.hash.substring(2)}html5AjaxHistoryO=new b;if(typeof arguments[0]!=="undefined"){if(typeof arguments[0]["before"]!=="undefined"){html5AjaxHistoryO.before=arguments[0]["before"]}if(typeof arguments[0]["insert"]!=="undefined"){html5AjaxHistoryO.insert=arguments[0]["insert"]}if(typeof arguments[0]["success"]!=="undefined"){html5AjaxHistoryO.success=arguments[0]["success"]}if(typeof arguments[0]["after"]!=="undefined"){html5AjaxHistoryO.after=arguments[0]["after"]}if(typeof arguments[0]["error"]!=="undefined"){html5AjaxHistoryO.error=arguments[0]["error"]}}if(typeof arguments[0]==="undefined"||typeof arguments[0]["selector"]==="undefined"){var c='a[href*="'+document.location.host+'"], a[href^="/"]'}else{var c=arguments[0]["selector"]}target=a(this).selector;a(c).live("click",function(b){b.preventDefault();html5AjaxHistoryO.call(a(this).attr("href"),target)})}})(jQuery)
